language: node_js

env:
  global:
    - FOO=FUBU_8

  matrix:
    - M1=ONE

build:
  pre_ci:
    - echo "true_9"

  ci:
    - printenv
#    - apt-get install tree
#    - tree
    - ls $SHIPPABLE_BUILD_DIR
    - tar -cvf sample_node_repo.tar $SHIPPABLE_BUILD_DIR
    - sha1sum sample_node_repo.tar
    - stat sample_node_repo.tar

  post_ci:
    - echo "true"

jobs:
  - name: sample_node_runCI
    type: runCI
    steps: []

  - name: ghPages_deploy
    type: runSh
    steps:
      - IN: sample_node_runCI
        switch: on
      - IN: sample_node_ciRepo
        switch: off
      - TASK:
          script:
            - TRANSFER=$(shipctl get_resource_state sample_node_runCI)
            - echo "Reading from $TRANSFER"
            - sha1sum $TRANSFER/sample_node_repo.tar      
            - stat $TRANSFER/sample_node_repo.tar
   
#integrations:
#  notifications:
#    - integrationName: "webhook-subint"
#      type: webhook
#      payload:
#        - state=$STATE
#        - repo_name=$REPO_FULL_NAME
#        - branch=$BRANCH
#        - build_number=$BUILD_NUMBER
#       - build_url=$BUILD_URL
##        - commit_message=$COMMIT_MESSAGE
#       - committer=$COMMITTER
#        - is_success=$is_success
#        - displayName=Shippable
#        - avatar=https://app.shippable.com/images/slack-aye-aye-yoga.png
#      on_start: always
#      on_success: always

#    - integrationName: resource-trigger-subint-2
#      type: webhook
#      payload:
#      - versionName=Shippable nginx-image-3 $BUILD_NUMBER
#      on_success: always
#      on_start: never
#      on_pull_request: always
